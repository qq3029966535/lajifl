# 实施计划

- [x] 1. 建立项目基础架构和核心接口


  - 创建项目目录结构，包含src、assets、tests等文件夹
  - 配置Vite构建工具和开发环境
  - 定义核心游戏引擎接口和基础类
  - _需求: 1.1, 1.2_



- [x] 2. 实现游戏引擎核心系统

- [x] 2.1 创建游戏引擎主循环和场景管理器

  - 编写GameEngine类，实现init、update、render循环
  - 实现SceneManager类，支持场景切换和状态管理

  - 创建基础Scene抽象类和MenuScene实现
  - _需求: 1.1, 4.1_

- [x] 2.2 实现实体组件系统(ECS)架构

  - 编写Entity、Component、System基础类
  - 实现Transform、Renderer、Movement、Collider组件
  - 创建ComponentManager用于组件的添加、删除和查询
  - _需求: 2.1, 3.1_

- [x] 2.3 建立渲染系统和Canvas管理


  - 实现Canvas2D渲染器用于2D元素绘制
  - 集成Three.js创建WebGL渲染器用于3D元素
  - 编写RenderSystem统一管理2D和3D渲染
  - _需求: 1.2, 1.3, 1.4_

- [x] 3. 实现轨道系统和游戏区域

- [x] 3.1 创建轨道数据结构和渲染


  - 编写Track类，定义轨道的起点、终点和宽度
  - 实现TrackSystem管理多条轨道的创建和布局
  - 添加轨道的视觉渲染，使用天空蓝色调
  - _需求: 4.2, 4.3, 1.2_

- [x] 3.2 实现轨道碰撞检测和位置验证


  - 编写轨道边界检测算法
  - 实现isValidPlacement方法验证垃圾桶放置位置
  - 创建getTrackAtPosition方法用于鼠标点击检测
  - _需求: 2.2, 4.2_

- [x] 4. 开发垃圾桶防御系统


- [x] 4.1 创建垃圾桶实体和类型定义


  - 定义TrashBinType枚举（厨余、可回收、有害、其他）
  - 编写TrashBin类，包含类型、位置、收集半径属性
  - 实现垃圾桶的Q版卡通渲染和动态表情
  - _需求: 2.1, 2.3, 1.3, 1.4_

- [x] 4.2 实现垃圾桶选择和放置机制


  - 编写键盘输入处理，响应1-4数字键选择垃圾桶
  - 实现鼠标点击放置垃圾桶到轨道上
  - 添加垃圾桶选择时的拟人化台词显示
  - _需求: 2.1, 2.2, 2.3_

- [x] 4.3 开发垃圾收集和分类逻辑


  - 实现canCollect方法验证垃圾桶能否收集特定垃圾类型
  - 编写collect方法处理垃圾收集，包含音效和动画
  - 添加分类正确时的欢呼动画和+10分音效
  - _需求: 2.4, 5.1, 7.1_

- [x] 5. 构建垃圾僵尸入侵系统

- [x] 5.1 创建垃圾僵尸实体和移动系统


  - 定义TrashType枚举和TrashZombie类
  - 实现僵尸沿轨道从右向左的移动逻辑
  - 使用Three.js创建Low Poly 3D僵尸模型
  - _需求: 3.1, 3.3, 1.3_

- [x] 5.2 实现垃圾僵尸类型和视觉特效


  - 创建4种垃圾僵尸类型（厨余、可回收、有害、其他）
  - 添加类型标识文字提示显示
  - 实现特殊视觉效果（如有害垃圾冒紫烟）
  - _需求: 3.2, 3.3_

- [x] 5.3 开发僵尸生成和管理系统


  - 编写TrashZombieSystem管理僵尸的生成和更新
  - 实现spawnZombie方法按关卡配置生成僵尸
  - 添加僵尸到达轨道终点的检测和失败触发
  - _需求: 3.4, 4.6_

- [x] 6. 实现碰撞检测和交互系统


- [x] 6.1 建立垃圾桶与僵尸的碰撞检测


  - 编写圆形碰撞检测算法用于垃圾桶收集范围
  - 实现垃圾桶与僵尸的实时碰撞检测
  - 添加碰撞事件的触发和处理机制
  - _需求: 2.4, 5.3_

- [x] 6.2 处理分类正确和错误的反馈


  - 实现分类正确时的音效播放和分数增加
  - 添加分类错误时的警报声和错误提示弹窗
  - 编写3秒纠错动画演示正确分类方式
  - _需求: 5.1, 5.2, 6.2_

- [x] 6.3 实现错误后的补救机制


  - 允许玩家在错误后切换垃圾桶类型重新尝试
  - 确保垃圾在被正确分类前持续移动
  - 添加多次尝试的逻辑处理
  - _需求: 5.3_

- [x] 7. 开发关卡系统和游戏流程

- [x] 7.1 创建关卡配置和数据结构


  - 定义5个关卡的配置数据（轨道数、垃圾类型、时间限制）
  - 编写LevelData类管理关卡信息和进度
  - 实现关卡的加载和初始化逻辑
  - _需求: 4.1, 4.2, 4.3, 4.4_

- [x] 7.2 实现2分钟倒计时系统


  - 编写Timer类管理关卡倒计时
  - 添加倒计时UI显示和实时更新
  - 实现时间耗尽时的失败判定
  - _需求: 4.4, 4.7_

- [x] 7.3 开发通关和失败判定逻辑


  - 实现所有垃圾正确分类的通关检测
  - 添加垃圾通过轨道的失败检测
  - 编写关卡结束时的状态处理和场景切换
  - _需求: 4.5, 4.6_

- [x] 8. 构建用户界面和反馈系统

- [x] 8.1 创建游戏HUD和信息显示




  - 设计并实现分数显示、时间显示、关卡信息UI
  - 添加垃圾桶选择状态的视觉指示
  - 创建清新薄荷绿主题的UI样式
  - _需求: 1.2, 4.4_

- [x] 8.2 实现错误提示和教育弹窗


  - 创建错误分类时的提示弹窗组件
  - 添加通关后的环保知识展示弹窗
  - 实现3秒纠错动画的UI展示
  - _需求: 5.2, 6.1, 6.2_

- [x] 8.3 开发失败和继续选择界面


  - 创建关卡失败时的选择弹窗（重新开始/继续本关）
  - 实现复活机会的扣除和显示
  - 添加关卡重置和继续的逻辑处理
  - _需求: 5.4, 5.5_

- [x] 9. 实现音效和动画系统

- [x] 9.1 集成Web Audio API和音效管理


  - 创建AudioManager类管理所有游戏音效
  - 实现成功分类的轻快电子音效果
  - 添加失败时的低沉警报声和屏幕震动
  - _需求: 7.1, 7.2_

- [x] 9.2 开发垃圾桶动画和表情系统


  - 实现垃圾桶的动态表情变化（如张嘴"嗷呜"）
  - 添加成功收集时的欢呼动画（如跳起转圈）
  - 创建垃圾桶待机时的呼吸动画效果
  - _需求: 1.4, 2.4, 7.1_

- [x] 9.3 添加环境音效和背景音乐


  - 实现鸟鸣与流水声的背景环境音效
  - 添加关卡切换时的过渡音效
  - 创建音效音量控制和静音功能
  - _需求: 7.3, 7.5_

- [x] 10. 开发教育强化和数据统计

- [x] 10.1 实现通关数据统计和展示


  - 编写分类数据的收集和计算逻辑
  - 创建通关后的数据展示界面（分类数量、准确率）
  - 添加环保冷知识的随机展示功能
  - _需求: 6.1_

- [x] 10.2 建立玩家进度和成就系统


  - 实现玩家数据的本地存储（localStorage）
  - 创建历史最高分和准确率曲线的记录
  - 添加自由模式的解锁和关卡选择功能
  - _需求: 6.3, 6.4_

- [x] 11. 实现错误处理和性能优化

- [x] 11.1 添加游戏错误处理机制


  - 创建GameErrorHandler类处理各种异常情况
  - 实现渲染错误的优雅降级（3D失败回退2D）
  - 添加音频失败时的静音运行模式
  - _设计文档: 错误处理部分_

- [x] 11.2 优化游戏性能和资源管理


  - 实现对象池管理垃圾僵尸的创建和销毁
  - 添加资源预加载和缓存机制
  - 优化渲染循环，确保60FPS稳定运行
  - _设计文档: 性能测试部分_

- [x] 12. 编写测试用例和质量保证

- [x] 12.1 创建核心功能的单元测试


  - 编写垃圾分类逻辑的测试用例
  - 测试碰撞检测算法的准确性
  - 验证关卡配置和游戏状态管理
  - _设计文档: 测试策略部分_

- [x] 12.2 实现集成测试和端到端测试


  - 测试完整的游戏流程（开始到通关）
  - 验证场景切换和数据持久化功能
  - 添加性能监控和帧率测试
  - _设计文档: 集成测试部分_

- [x] 13. 最终集成和部署准备


- [x] 13.1 整合所有系统并进行最终测试


  - 将所有子系统集成到完整的游戏中
  - 进行全面的功能测试和用户体验验证
  - 修复集成过程中发现的问题
  - _需求: 所有需求的综合验证_

- [x] 13.2 优化构建配置和部署设置


  - 配置生产环境的构建优化
  - 添加资源压缩和代码分割
  - 准备游戏的部署文档和说明
  - _设计文档: 部署相关配置_